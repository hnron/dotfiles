---
- name: rbenv | install rbenv
  git:
    repo: https://github.com/rbenv/rbenv.git
    dest: ~/.rbenv

- name: rbenv | install rbenv-build
  git:
    repo: https://github.com/rbenv/ruby-build.git
    dest: ~/.rbenv/plugins/ruby-build

- name: rbenv | install ruby by rbenv
  shell: "rbenv install -s {{ item.version }}"
  loop:
    "{{ rbenv }}"

- name: rbenv | gem install
  gem:
    name: "{{ item.1 }}"
    executable: ~/.rbenv/shims/gem
  environment:
    RBENV_VERSION: "{{ item.0.version }}"
  loop:
    "{{ rbenv | subelements('packages') | list }}"

